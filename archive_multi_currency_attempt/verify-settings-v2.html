<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Settings Verification</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .animate-spring-up {
            animation: springUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes springUp {
            from {
                opacity: 0;
                transform: translate(-50%, -40%) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
    </style>
</head>

<body>
    <div id="app"></div>
    <script type="module">
        import { createApp } from 'vue';
        import { SettingsPage } from './js/pages/settings-page.js';

        const app = createApp({
            components: { 'settings-page': SettingsPage },
            template: `
                <div class="p-10 bg-gray-100 min-h-screen">
                    <h1 class="text-2xl mb-4">Refined Settings Verification Harness</h1>
                    <div class="max-w-md mx-auto relative">
                        <settings-page 
                            :config="config"
                            :app-mode="'GUEST'"
                            @update-config="handleUpdateConfig"
                        ></settings-page>
                    </div>
                    <div class="mt-4 p-4 bg-white rounded shadow">
                        <h3 class="font-bold">Last Config Update:</h3>
                        <pre v-if="lastUpdate" class="text-xs">{{ JSON.stringify(lastUpdate, null, 2) }}</pre>
                        <div v-else class="text-gray-400">Waiting for update...</div>
                    </div>
                </div>
            `,
            data() {
                return {
                    config: {
                        user_name: 'TestUser',
                        fx_rate: 0.22,
                        baseCurrency: 'JPY',
                        activeCurrencies: ['JPY', 'TWD'],
                        exchangeRates: { 'TWD': 0.22 }
                    },
                    lastUpdate: null
                };
            },
            methods: {
                handleUpdateConfig(newConfig) {
                    this.lastUpdate = newConfig;
                    this.config = { ...this.config, ...newConfig };
                    console.log('Config Updated:', newConfig);
                }
            },
            provide() {
                return {
                    dialog: {
                        alert: (msg) => alert(msg),
                        confirm: (msg) => confirm(msg)
                    }
                };
            }
        });
        app.mount('#app');
    </script>
</body>

</html>